<div class="container mt-4">
  <h2>ğŸ“‹ Demandes d'Approbation</h2>

  <!-- Loading State -->
  <div *ngIf="loading" class="py-3 text-center">
    <span>â³ Chargement...</span>
  </div>

  <div *ngIf="!loading" class="requests-container">
    <!-- CLASS REQUESTS SECTION -->
    <div class="section">
      <h3>ğŸ« Demandes de Classe</h3>
      
      <!-- Search Bar -->
      <div class="search-section">
        <div class="input-group mb-3">
          <span class="input-group-text">ğŸ”</span>
          <input type="text" class="form-control" placeholder="Chercher par nom, description, ou enseignant..." 
                 [(ngModel)]="classSearchQuery" (keyup)="onClassSearchChange(classSearchQuery)">
          <button class="btn btn-outline-secondary" type="button" (click)="classSearchQuery = ''; onClassSearchChange('')">âœ• Effacer</button>
        </div>
        <div class="search-info">
          <small>RÃ©sultats: <strong>{{ filteredClassRequests.length }}</strong> / Total: <strong>{{ classRequests.length }}</strong></small>
        </div>
      </div>

      <!-- Empty State -->
      <div *ngIf="filteredClassRequests.length === 0" class="empty-state">
        <i class="fas fa-inbox" style="font-size: 3rem; color: #ddd;"></i>
        <p>Aucune demande de classe en attente</p>
      </div>

      <!-- Request Cards -->
      <div *ngIf="filteredClassRequests.length > 0">
        <div *ngFor="let r of paginatedClassRequests" class="card">
          <div class="card-body">
            <h5>{{ r.name }}</h5>
            <p>{{ r.description }}</p>
            <p class="small text-muted">ğŸ‘¤ Par: {{ r.teacher?.name }}</p>
            <div style="display: flex; gap: 10px; margin-top: 15px;">
              <button class="btn btn-success" (click)="approveClass(r)">âœ“ Approuver</button>
              <button class="btn btn-danger" (click)="rejectClass(r)">âœ• Rejeter</button>
            </div>
          </div>
        </div>

        <!-- Pagination -->
        <div class="pagination-section">
          <nav aria-label="Page navigation">
            <ul class="pagination">
              <li class="page-item" [ngClass]="classPage === 1 ? 'disabled' : ''">
                <button class="page-link" (click)="previousClassPage()" [disabled]="classPage === 1">â† PrÃ©cÃ©dent</button>
              </li>
              <li class="page-item" *ngFor="let page of [].constructor(classTotalPages); let i = index" [ngClass]="classPage === i + 1 ? 'active' : ''">
                <button class="page-link" (click)="goToClassPage(i + 1)">{{ i + 1 }}</button>
              </li>
              <li class="page-item" [ngClass]="classPage === classTotalPages ? 'disabled' : ''">
                <button class="page-link" (click)="nextClassPage()" [disabled]="classPage === classTotalPages">Suivant â†’</button>
              </li>
            </ul>
          </nav>
          <div class="pagination-info">
            <small>Page <strong>{{ classPage }}</strong> / <strong>{{ classTotalPages }}</strong></small>
          </div>
        </div>
      </div>
    </div>

    <!-- COURSE REQUESTS SECTION -->
    <div class="section">
      <h3>ğŸ“š Demandes de Cours</h3>
      
      <!-- Search Bar -->
      <div class="search-section">
        <div class="input-group mb-3">
          <span class="input-group-text">ğŸ”</span>
          <input type="text" class="form-control" placeholder="Chercher par nom, description, ou enseignant..." 
                 [(ngModel)]="courseSearchQuery" (keyup)="onCourseSearchChange(courseSearchQuery)">
          <button class="btn btn-outline-secondary" type="button" (click)="courseSearchQuery = ''; onCourseSearchChange('')">âœ• Effacer</button>
        </div>
        <div class="search-info">
          <small>RÃ©sultats: <strong>{{ filteredCourseRequests.length }}</strong> / Total: <strong>{{ courseRequests.length }}</strong></small>
        </div>
      </div>

      <!-- Empty State -->
      <div *ngIf="filteredCourseRequests.length === 0" class="empty-state">
        <i class="fas fa-inbox" style="font-size: 3rem; color: #ddd;"></i>
        <p>Aucune demande de cours en attente</p>
      </div>

      <!-- Request Cards -->
      <div *ngIf="filteredCourseRequests.length > 0">
        <div *ngFor="let r of paginatedCourseRequests" class="card">
          <div class="card-body">
            <h5>{{ r.name }}</h5>
            <p>{{ r.description }}</p>
            <p class="small text-muted">ğŸ‘¤ Par: {{ r.teacher?.name }}</p>
            <div style="display: flex; gap: 10px; margin-top: 15px;">
              <button class="btn btn-success" (click)="approveCourse(r)">âœ“ Approuver</button>
              <button class="btn btn-danger" (click)="rejectCourse(r)">âœ• Rejeter</button>
            </div>
          </div>
        </div>

        <!-- Pagination -->
        <div class="pagination-section">
          <nav aria-label="Page navigation">
            <ul class="pagination">
              <li class="page-item" [ngClass]="coursePage === 1 ? 'disabled' : ''">
                <button class="page-link" (click)="previousCoursePage()" [disabled]="coursePage === 1">â† PrÃ©cÃ©dent</button>
              </li>
              <li class="page-item" *ngFor="let page of [].constructor(courseTotalPages); let i = index" [ngClass]="coursePage === i + 1 ? 'active' : ''">
                <button class="page-link" (click)="goToCoursePage(i + 1)">{{ i + 1 }}</button>
              </li>
              <li class="page-item" [ngClass]="coursePage === courseTotalPages ? 'disabled' : ''">
                <button class="page-link" (click)="nextCoursePage()" [disabled]="coursePage === courseTotalPages">Suivant â†’</button>
              </li>
            </ul>
          </nav>
          <div class="pagination-info">
            <small>Page <strong>{{ coursePage }}</strong> / <strong>{{ courseTotalPages }}</strong></small>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
